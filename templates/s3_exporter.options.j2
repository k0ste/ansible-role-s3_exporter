{{ '## s3_exporter' }}
{{ '# ' + ansible_managed }}
{{ '# Do not edit manually' }}

{% if vars['s3_exporter_settings'] is defined and
  vars['s3_exporter_settings'] != '' %}
{% for s in vars['s3_exporter_settings'] %}
{% if loop['first'] %}
{% if s['aws_access_key'] is defined and s['aws_access_key'] != '' %}
{{ 'AWS_ACCESS_KEY_ID=\"' + s['aws_access_key'] + '\"' }}
{% else %}
{{ 'AWS_ACCESS_KEY_ID=""' }}
{% endif %}
{% if s['aws_secret_key'] is defined and s['aws_secret_key'] != '' %}
{{ 'AWS_SECRET_ACCESS_KEY=\"' + s['aws_secret_key'] + '\"' }}
{% else %}
{{ 'AWS_SECRET_ACCESS_KEY=""' }}
{% endif %}
{% if s['aws_region'] is defined and s['aws_region'] != '' %}
{{ 'AWS_REGION=\"' + s['aws_region'] + '\"' }}
{% else %}
{{ 'AWS_REGION=""' }}
{% endif %}
{{ 'OPTIONS=\"' -}}
{% endif %}
{% if s['web_listen_address'] is defined and s['web_listen_address'] != '' %}
{{ ' --web.listen-address=' + s['web_listen_address'] -}}
{% endif %}
{% if s['web_metrics_path'] is defined and s['web_metrics_path'] != '' %}
{{ ' --web.metrics-path=' + s['web_metrics_path'] -}}
{% endif %}
{% if s['web_probe_path'] is defined and s['web_probe_path'] != '' %}
{{ ' --web.probe-path=' + s['web_probe_path'] -}}
{% endif %}
{% if s['web_discovery_path'] is defined and s['web_discovery_path'] != '' %}
{{ ' --web.discovery-path=' + s['web_discovery_path'] -}}
{% endif %}
{% if s['s3_endpoint_url'] is defined and s['s3_endpoint_url'] != '' %}
{{ ' --s3.endpoint-url=' + s['s3_endpoint_url'] -}}
{% endif %}
{% if s['s3_disable_ssl'] is defined and s['s3_disable_ssl'] == 'true' %}
{{ ' --s3.disable-ssl' -}}
{% endif %}
{% if s['s3_force_path_style'] is defined and
  s['s3_force_path_style'] == 'true' %}
{{ ' --s3.force-path-style' -}}
{% endif %}
{% if s['http_tls_insecure'] is defined and s['http_tls_insecure'] == 'true' %}
{{ ' --http.tls-insecure' -}}
{% endif %}
{% if s['http_timeout'] is defined and s['http_timeout'] != '' %}
{{ ' --http.timeout=' ~ s['http_timeout'] -}}
{% endif %}
{% if s['log_level'] is defined and s['log_level'] in ['debug', 'info', 'warn',
  'error', 'fatal'] %}
{{ ' --log.level=' + s['log_level'] -}}
{% endif %}
{% if s['log_format'] is defined and s['log_format'] != '' %}
{{ ' --log.format=' + s['log_format'] -}}
{% endif %}
{% if loop['last'] %}
{{- '\"' }}
{% endif %}
{% endfor %}
{% else %}
{{ 'OPTIONS=""' }}
{% endif %}
